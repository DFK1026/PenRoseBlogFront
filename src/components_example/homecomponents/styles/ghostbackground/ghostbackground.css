/* Ghost 背景：作用域样式，避免污染全局 */

/* 修复在 Tailwind Preflight 下的几何扭曲问题：
   该组件大量使用 padding 百分比制造形状，需 content-box */
.ghost-overlay, .ghost-overlay * {
  box-sizing: content-box;
}

/* 覆盖容器：充当背景层，不阻止下层交互；父容器需 position:relative */
.ghost-overlay {
  position: absolute;
  inset: 0;
  pointer-events: none; /* 默认不拦截事件 */
  overflow: hidden;
}

.scene-container {
  position: relative;
  width: 140px;
  height: 160px;
  pointer-events: auto; /* 幽灵本体可交互 */
}

.scene-container:focus { outline: none; }

/* emerge-clip 负责裁剪黑洞以下的部分，使幽灵与星星从洞中冒出 */
.emerge-clip {
  position: absolute;
  left: 0;
  right: 0;
  top: 0;
  bottom: 8px; /* 与 .shadow 高度对齐，隐藏黑洞以下 */
  overflow: hidden;
}

.scene-container.run-away .ghost {
  transform: rotateX(-10deg) scale3d(1.4, 4, 1) translate3d(0, 130%, -30px);
  transition: transform 800ms ease;
}

.scene-container.descend .ghost {
  transform: translate3d(0, 130%, 0);
}

.ghost-container {
  position: relative;
  width: 80px;
  height: 140px;
  padding: 20px 30px 0 30px;
  overflow: hidden;
  perspective: 30px;
}

.ghost {
  position: relative;
  height: 115px;
  z-index: 1;
  transition: transform 2000ms ease-out;
}

.ghost.hover {
  -webkit-animation: hover 600ms ease-in-out infinite alternate;
  animation: hover 600ms ease-in-out infinite alternate;
}

.ghost-head {
  position: relative;
  width: 80px;
  height: 0;
  padding-top: 100%;
  border-radius: 100%;
  background-color: #F0EFDC;
}

.ghost-head .ghost-face {
  position: absolute;
  bottom: 10px;
  left: 10px;
  width: 50px;
  height: 30px;
  z-index: 1;
}

.eyes-row, .mouth-row { position: relative; height: 10px; }
.mouth-row { margin-top: 3px; }

.eye {
  height: 10px;
  width: 10px;
  background-color: #271917;
  border-radius: 100%;
  position: absolute;
  bottom: 0;
  transition: height 50ms ease;
}
.eye.left { left: 5px; }
.eye.right { right: 5px; }
.eye.blink { height: 0; }

.mouth {
  position: absolute;
  left: 50%;
  top: 0;
  height: 10px;
  transform: translate3d(-50%, 0, 0);
}
.mouth .mouth-top {
  width: 18px; height: 2px; border-radius: 2px 2px 0 0; background-color: #271917;
}
.mouth .mouth-bottom {
  position: absolute; width: 18px; height: 8px; bottom: 0; overflow: hidden; transition: height 150ms ease;
}
.mouth .mouth-bottom:after {
  content: ""; display: block; position: absolute; left: 0; bottom: 0; width: 18px; height: 16px; border-radius: 100%; background-color: #271917;
}
.mouth.open .mouth-bottom { height: 16px; }
.mouth.closed .mouth-bottom { height: 0; }

.cheek { position: absolute; top: 0; width: 12px; height: 4px; background-color: #F5C1B6; border-radius: 100%; }
.cheek.left { left: 0; }
.cheek.right { right: 0; }

.ghost-body { position: absolute; top: 40px; height: 0; width: 80px; padding-top: 85%; background-color: #F0EFDC; }

.ghost-hand { height: 36px; width: 22px; background: #F0EFDC; border-radius: 100%/90%; position: absolute; }
.ghost-hand.hand-left { left: -12px; top: 10px; transform: rotateZ(-45deg); left: 0; top: 5px; transform-origin: bottom center; }
.ghost-hand.hand-left.waving { -webkit-animation: waving 400ms linear; animation: waving 400ms linear; }
.ghost-hand.hand-right { right: -12px; top: 10px; transform: rotateZ(45deg); }

.ghost-skirt { position: absolute; left: 0; bottom: 0; width: 100%; display: flex; transform: translateY(50%); }
.ghost-skirt .pleat { width: 20%; height: 8px; border-radius: 100%; }
.ghost-skirt .pleat.down { background-color: #F0EFDC; }
.ghost-skirt .pleat.up { background-color: #292B25; position: relative; top: 1px; }

.shadow-container { transition: transform 800ms ease; }
.shadow-container.disappear { transform: scale3d(0, 1, 1); transition: transform 400ms ease; }

.shadow { position: absolute; top: calc(100% - 4px); left: 0; width: 100%; height: 8px; background-color: #1B1D18; border-radius: 100%; z-index: -1; }
.shadow-bottom { position: absolute; top: 100%; left: 0; height: 4px; width: 100%; overflow: hidden; }
.shadow-bottom:after { content: ""; display: block; width: 100%; position: absolute; height: 8px; left: 0; bottom: 0; border-radius: 100%; background-color: #1B1D18; z-index: 2; }

/* Portal 展开与冒出动画态：
  1) portal-emerge: 黑洞从细线展开；
  2) portal-open: 黑洞达到完整宽度；
  3) emerging: 幽灵从洞中向上冒出（配合 stars-out 让星星位移到目标位置） */
.shadow { transform-origin: center; }
/* 初始无洞 -> 展开成完整黑洞 */
.scene-container.portal-emerge .shadow { transform: scaleX(0); opacity: 0; }
.scene-container.portal-emerge .shadow-bottom:after { transform: scaleX(0); opacity: 0; transform-origin: center; }
.scene-container.portal-emerge.portal-open .shadow { transform: scaleX(1); opacity: 1; transition: transform 450ms ease, opacity 300ms ease; }
.scene-container.portal-emerge.portal-open .shadow-bottom:after { transform: scaleX(1); opacity: 1; transition: transform 450ms ease, opacity 300ms ease; }

/* 关闭黑洞 */
.scene-container.portal-close .shadow { transform: scaleX(0); opacity: 0; transition: transform 300ms ease, opacity 250ms ease; }
.scene-container.portal-close .shadow-bottom:after { transform: scaleX(0); opacity: 0; transform-origin: center; transition: transform 300ms ease, opacity 250ms ease; }

/* 幽灵从洞中冒出 */
.scene-container.portal-emerge .ghost { transform: translate3d(0, 130%, 0); }
.scene-container.portal-emerge.emerging .ghost { transform: translate3d(0, 0, 0); transition: transform 900ms cubic-bezier(0.22, 1, 0.36, 1); }

/* 幽灵回洞 */
.scene-container.into-hole .ghost { transform: translate3d(0, 130%, 0); transition: transform 820ms cubic-bezier(0.24, 0.74, 0.3, 1); }

/* 星星汇聚至黑洞并进入（位置靠近底部中间，随后被裁剪） */
.scene-container.stars-to-hole .star { transition: top 650ms ease, left 650ms ease; }
/* 将星星目标位置设在容器底部之外，确保完全被 emerge-clip 裁剪 */
.scene-container.stars-to-hole .star-1 { top: 104%; left: 49%; }
.scene-container.stars-to-hole .star-2 { top: 105%; left: 50%; }
.scene-container.stars-to-hole .star-3 { top: 106%; left: 51%; }
.scene-container.stars-to-hole .star-4 { top: 104.5%; left: 52%; }
.scene-container.stars-to-hole .star-5 { top: 105.5%; left: 53%; }
.scene-container.stars-to-hole .star-6 { top: 106.5%; left: 54%; }

/* 黑洞逐步收缩（与回洞同步） */
.scene-container.portal-shrink .shadow { transform: scaleX(0.35); opacity: 1; transition: transform 820ms ease; }
.scene-container.portal-shrink .shadow-bottom:after { transform: scaleX(0.35); opacity: 1; transition: transform 820ms ease; }

.star { position: absolute; -webkit-animation: twinkle 2s infinite linear; animation: twinkle 2s infinite linear; transition: top 400ms ease-out, left 400ms ease-out; }
.star.round .star-element { height: 9px; width: 9px; border-radius: 100%; }
.star.pointy { transform: rotate(-15deg); }
.star.pointy .star-element { height: 6px; width: 6px; }
.star.pointy .star-element:before, .star.pointy .star-element:after { content: ""; display: block; position: absolute; background: green; border-radius: 6px; }
.star.pointy .star-element:before { height: 6px; width: 12px; left: -3px; top: 0; transform: skewX(60deg); }
.star.pointy .star-element:after { height: 12px; width: 6px; right: 0; bottom: -3px; transform: skewY(-60deg); }

.star.orange .star-element, .star.orange .star-element:before, .star.orange .star-element:after { background-color: #DF814D; }
.star.yellow .star-element, .star.yellow .star-element:before, .star.yellow .star-element:after { background-color: #FFD186; }
.star.blue .star-element, .star.blue .star-element:before, .star.blue .star-element:after { background-color: #83D0BC; }

.star-1 { top: 130%; left: 40%; transition-delay: 200ms; -webkit-animation-delay: 0ms; animation-delay: 0ms; z-index: 2; }
.star-2 { top: 130%; left: 44%; transition-delay: 250ms; -webkit-animation-delay: 200ms; animation-delay: 200ms; }
.star-3 { top: 130%; left: 48%; transition-delay: 300ms; -webkit-animation-delay: 400ms; animation-delay: 400ms; z-index: 2; }
.star-4 { top: 130%; left: 52%; transition-delay: 350ms; -webkit-animation-delay: 600ms; animation-delay: 600ms; }
.star-5 { top: 130%; left: 56%; transition-delay: 400ms; -webkit-animation-delay: 800ms; animation-delay: 800ms; z-index: 2; }
.star-6 { top: 130%; left: 60%; transition-delay: 450ms; -webkit-animation-delay: 1000ms; animation-delay: 1000ms; }

.move-stars-out .star-element { -webkit-animation: star-entrance 1500ms; animation: star-entrance 1500ms; }
.stars-out .star { transition: top 1500ms ease-out, left 1500ms ease-out; }
.stars-out .star-1 { top: 75%; left: 6%; }
.stars-out .star-2 { top: 35%; left: 88%; }
.stars-out .star-3 { top: 8%; left: 20%; }
.stars-out .star-4 { top: 70%; left: 92%; }
.stars-out .star-5 { top: 35%; left: 4%; }
.stars-out .star-6 { top: 2%; left: 70%; }

.stars-out .star-1 { transition-delay: 0ms, 0ms; }
.stars-out .star-1 .star-element { -webkit-animation-delay: 0ms; animation-delay: 0ms; }
.stars-out .star-2 { transition-delay: 200ms, 200ms; }
.stars-out .star-2 .star-element { -webkit-animation-delay: 200ms; animation-delay: 200ms; }
.stars-out .star-3 { transition-delay: 400ms, 400ms; }
.stars-out .star-3 .star-element { -webkit-animation-delay: 400ms; animation-delay: 400ms; }
.stars-out .star-4 { transition-delay: 600ms, 600ms; }
.stars-out .star-4 .star-element { -webkit-animation-delay: 600ms; animation-delay: 600ms; }
.stars-out .star-5 { transition-delay: 800ms, 800ms; }
.stars-out .star-5 .star-element { -webkit-animation-delay: 800ms; animation-delay: 800ms; }
.stars-out .star-6 { transition-delay: 1000ms, 1000ms; }
.stars-out .star-6 .star-element { -webkit-animation-delay: 1000ms; animation-delay: 1000ms; }

.move-stars-in .star-element { -webkit-animation: star-exit 400ms linear; animation: star-exit 400ms linear; }
.move-stars-in .star-1 .star-element { -webkit-animation-delay: 100ms; animation-delay: 100ms; }
.move-stars-in .star-2 .star-element { -webkit-animation-delay: 150ms; animation-delay: 150ms; }
.move-stars-in .star-3 .star-element { -webkit-animation-delay: 200ms; animation-delay: 200ms; }
.move-stars-in .star-4 .star-element { -webkit-animation-delay: 250ms; animation-delay: 250ms; }
.move-stars-in .star-5 .star-element { -webkit-animation-delay: 300ms; animation-delay: 300ms; }
.move-stars-in .star-6 .star-element { -webkit-animation-delay: 350ms; animation-delay: 350ms; }

/* 动画 */
@-webkit-keyframes hover { 0% { top: 0; } 100% { top: 8px; } }
@keyframes hover { 0% { top: 0; } 100% { top: 8px; } }

@-webkit-keyframes star-entrance { 0% { transform: rotate(-735deg) scale(0, 0);} 100% { transform: rotate(0) scale(1, 1);} }
@keyframes star-entrance { 0% { transform: rotate(-735deg) scale(0, 0);} 100% { transform: rotate(0) scale(1, 1);} }

@-webkit-keyframes star-exit { 0% { transform: rotate(0) scale(1, 1);} 100% { transform: rotate(360deg) scale(0, 0);} }
@keyframes star-exit { 0% { transform: rotate(0) scale(1, 1);} 100% { transform: rotate(360deg) scale(0, 0);} }

@-webkit-keyframes twinkle { 0% { transform: rotate(0deg) scale(1, 1);} 25% { transform: rotate(10deg) scale(0.8, 0.8);} 50% { transform: rotate(0deg) scale(0.9, 0.9);} 75% { transform: rotate(-20deg) scale(0.6, 0.6);} 100% { transform: rotate(0deg) scale(1, 1);} }
@keyframes twinkle { 0% { transform: rotate(0deg) scale(1, 1);} 25% { transform: rotate(10deg) scale(0.8, 0.8);} 50% { transform: rotate(0deg) scale(0.9, 0.9);} 75% { transform: rotate(-20deg) scale(0.6, 0.6);} 100% { transform: rotate(0deg) scale(1, 1);} }

@-webkit-keyframes waving { 0% { transform: rotate(-45deg);} 25% { transform: rotate(-55deg);} 50% { transform: rotate(-45deg);} 75% { transform: rotate(-55deg);} 100% { transform: rotate(-45deg);} }
@keyframes waving { 0% { transform: rotate(-45deg);} 25% { transform: rotate(-55deg);} 50% { transform: rotate(-45deg);} 75% { transform: rotate(-55deg);} 100% { transform: rotate(-45deg);} }
